<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="Content-Language" content="English"/>
        <link rel="stylesheet" type="text/css" href="style.css" media="screen"/>
        <script src="header.js"></script>
        <script src="intervals.js"></script>
        <script src="keys.js"></script>
        <script src="modes.js"></script>
        <script src="tunings.js"></script>
        <script src="menu.js"></script>
        <script>

            function drawFretBoard(canvas_elem) {
                // Box width
                var bw = window.innerWidth * .9;
                // Box height
                var bh = window.innerHeight * 0.9;
                // Padding
                var p = 0;

                var n_frets = 24;
                var n_strings = 6;

                x_increment = bw / n_frets;
                y_increment = bh / n_strings;

                if (y_increment > x_increment) {
                    y_increment = x_increment;
                    bh = y_increment * n_strings;
                }

                canvas_elem.width = bw + 1;
                canvas_elem.height = bh + 1;

                // var canvas = document.getElementById("canvas");
                var context = canvas_elem.getContext("2d");

                // vertical lines
                for (var x = 0; x <= bw; x += x_increment) {
                    context.moveTo(0.5 + x + p, p);
                    context.lineTo(0.5 + x + p, bh + p);
                }

                // horizontal lines
                for (var y = 0; y <= bh; y += y_increment) {
                    context.moveTo(p, 0.5 + y + p);
                    context.lineTo(bw + p, 0.5 + y + p);
                }
                context.strokeStyle = "black";
                context.stroke();
            }

            function addFretBoard() {
                var content_elem = document.getElementById("content")
                var canvas_elem = document.createElement("canvas")
                content_elem.appendChild(canvas_elem)
                // <canvas id="canvas" width="420px" height="420px" style="background: #fff; margin:20px"></canvas>

                drawFretBoard(canvas_elem);
            }

            /*
             * Each menu item is a drop down select box
             *
             *
             */
            function addMenu(menu_data) {
                var menu_elem = document.getElementById("menu");
                var form_elem = document.createElement("form");
                var list_elem = document.createElement("ul");
                for (var index in menu_data) {
                    var item = menu_data[index];
                    var label = item["label"];
                    var default_value = item["default"];
                    var values = item["values"];

                    var item_elem = document.createElement("li");

                    var div_elem = document.createElement("div");
                    var label_elem = document.createElement("label");
                    label_elem.innerText = label;

                    var select_elem = document.createElement("select");
                    select_elem.name = label;
                    for (var value in values) {
                        var option_elem = document.createElement("option");
                        option_elem.text = values[value];
                        option_elem.value = values[value];
                        select_elem.appendChild(option_elem);
                    }

                    div_elem.appendChild(label_elem)
                    div_elem.appendChild(select_elem)

                    item_elem.appendChild(div_elem);
                    list_elem.appendChild(item_elem);
                }
                form_elem.appendChild(list_elem)
                menu_elem.appendChild(form_elem);
            }

            function addHeader(header_data) {
                var header_elem = document.getElementById("header");

                var img_elem = document.createElement("img");
                for (var attr in header_data["image"]) {
                    if (header_data["image"].hasOwnProperty(attr)) {
                        img_elem.setAttribute(attr, header_data["image"][attr]);
                    }
                }
                header_elem.appendChild(img_elem);

                var h1_elem = document.createElement("h1");
                h1_elem.innerHTML = "<a href=\"#\">" + header_data["title"] + "</a>";
                header_elem.appendChild(h1_elem);

                var h2_elem = document.createElement("h2");
                h2_elem.innerHTML = header_data["caption"];
                header_elem.appendChild(h2_elem);
            }

            function addTitle(title) {
                var title_elem = document.createElement("title");
                title_elem.innerHTML = title;
                document.getElementsByTagName("head")[0].appendChild(title_elem);
            }

            /*
             * On load, set the .section states from localStorage.
             */
            window.onload = function () {
                addTitle(header_data["title"]);
                addHeader(header_data);
                addMenu(menu_data);
                addFretBoard();
            };

        </script>
    </head>

    <body>
        <div id="wrap">
            <div id="header"></div>
            <div id="menu"></div>
            <div id="menubottom"></div>
            <div id="content"></div>

            <div id="footer">
                <p>
                    Click headings to show/hide sections.
                </p>
                <p>
                    Requires recent HTML5 browser with javascript enabled.  Mobile and tablet ready.
                </p>
            </div>
        </div>
    </body>

</html>